<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="ä½¿ç”¨Tensorflowå®ç°å¾ªç¯ç¥ç»ç½‘ç»œçš„ç›¸å…³ç®—æ³•">
<meta property="og:type" content="article">
<meta property="og:title" content="Tensorflowä¸å¾ªç¯ç¥ç»ç½‘ç»œ">
<meta property="og:url" content="http://yoursite.com/2020/12/06/Tensorflow-and-Recurrent-neural-network/index.html">
<meta property="og:site_name" content="ccclll777&#39;s blogs">
<meta property="og:description" content="ä½¿ç”¨Tensorflowå®ç°å¾ªç¯ç¥ç»ç½‘ç»œçš„ç›¸å…³ç®—æ³•">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201205132144831.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201205135047953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JhaWR1XzQxODcxNzk0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201205140232940.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201205140814287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JhaWR1XzQxODcxNzk0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201205140822877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JhaWR1XzQxODcxNzk0,size_16,color_FFFFFF,t_70">
<meta property="article:published_time" content="2020-12-06T07:56:00.000Z">
<meta property="article:modified_time" content="2020-12-06T08:04:31.866Z">
<meta property="article:author" content="ccclll777">
<meta property="article:tag" content="python">
<meta property="article:tag" content="æ·±åº¦å­¦ä¹ æ¡†æ¶">
<meta property="article:tag" content="tensorflow">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20201205132144831.png">

<link rel="canonical" href="http://yoursite.com/2020/12/06/Tensorflow-and-Recurrent-neural-network/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Tensorflowä¸å¾ªç¯ç¥ç»ç½‘ç»œ | ccclll777's blogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="ccclll777's blogs" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
<a href="https://github.com/ccclll777" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ccclll777's blogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/06/Tensorflow-and-Recurrent-neural-network/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ccclll777">
      <meta itemprop="description" content="èƒ¸æ€€çŒ›è™ ç»†å—…è”·è–‡">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ccclll777's blogs">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Tensorflowä¸å¾ªç¯ç¥ç»ç½‘ç»œ
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-12-06 15:56:00 / ä¿®æ”¹æ—¶é—´ï¼š16:04:31" itemprop="dateCreated datePublished" datetime="2020-12-06T15:56:00+08:00">2020-12-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">æ·±åº¦å­¦ä¹ </span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>11 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <pre><code>ä½¿ç”¨Tensorflowå®ç°å¾ªç¯ç¥ç»ç½‘ç»œçš„ç›¸å…³ç®—æ³•</code></pre><a id="more"></a>
<h1 id="åºåˆ—çš„è¡¨ç¤ºæ–¹æ³•"><a href="#åºåˆ—çš„è¡¨ç¤ºæ–¹æ³•" class="headerlink" title="åºåˆ—çš„è¡¨ç¤ºæ–¹æ³•"></a>åºåˆ—çš„è¡¨ç¤ºæ–¹æ³•</h1><h2 id="Embedding-å±‚"><a href="#Embedding-å±‚" class="headerlink" title="Embedding å±‚"></a>Embedding å±‚</h2><ul>
<li>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œå•è¯çš„è¡¨ç¤ºå‘é‡å¯ä»¥ç›´æ¥é€šè¿‡è®­ç»ƒçš„æ–¹å¼å¾—åˆ°ï¼Œæˆ‘ä»¬æŠŠå•è¯çš„è¡¨ç¤ºå±‚ å«ä½œ Embedding å±‚ã€‚</li>
<li>Embedding å±‚å®ç°èµ·æ¥éå¸¸ç®€å•ï¼Œæ„å»ºä¸€ä¸ª shape ä¸º[ğ‘vocab, ğ‘›]çš„æŸ¥è¯¢è¡¨å¯¹è±¡ tableï¼Œå¯¹äºä»»æ„çš„å•è¯ç¼–å·ğ‘–ï¼Œåªéœ€è¦æŸ¥è¯¢åˆ°å¯¹åº”ä½ç½®ä¸Šçš„å‘é‡å¹¶è¿”å›å³å¯:ğ’— = ğ‘¡ğ‘ğ‘ğ‘™ğ‘’[ğ‘–]</li>
<li>Embedding å±‚æ˜¯å¯è®­ç»ƒçš„ï¼Œå®ƒå¯æ”¾ç½®åœ¨ç¥ç»ç½‘ç»œä¹‹å‰ï¼Œå®Œæˆå•è¯åˆ°å‘é‡çš„è½¬æ¢ï¼Œå¾—åˆ°çš„è¡¨ ç¤ºå‘é‡å¯ä»¥ç»§ç»­é€šè¿‡ç¥ç»ç½‘ç»œå®Œæˆåç»­ä»»åŠ¡ï¼Œå¹¶è®¡ç®—è¯¯å·®Lï¼Œé‡‡ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æ¥å®ç°ç«¯ åˆ°ç«¯(end-to-end)çš„è®­ç»ƒã€‚</li>
<li>åœ¨ TensorFlow ä¸­ï¼Œå¯ä»¥é€šè¿‡ layers.Embedding(ğ‘vocab,ğ‘›)æ¥å®šä¹‰ä¸€ä¸ª Word Embedding å±‚ï¼Œå…¶ä¸­ğ‘vocabå‚æ•°æŒ‡å®šè¯æ±‡æ•°é‡ï¼Œğ‘›æŒ‡å®šå•è¯å‘é‡çš„é•¿åº¦</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = tf.range(<span class="number">10</span>) <span class="comment"># ç”Ÿæˆ 10 ä¸ªå•è¯çš„æ•°å­—ç¼–ç </span></span><br><span class="line">x = tf.random.shuffle(x) <span class="comment"># æ‰“æ•£</span></span><br><span class="line"><span class="comment"># åˆ›å»ºå…± 10 ä¸ªå•è¯ï¼Œæ¯ä¸ªå•è¯ç”¨é•¿åº¦ä¸º 4 çš„å‘é‡è¡¨ç¤ºçš„å±‚ </span></span><br><span class="line">net = layers.Embedding(<span class="number">10</span>, <span class="number">4</span>)</span><br><span class="line">out = net(x) <span class="comment"># è·å–è¯å‘é‡</span></span><br><span class="line"></span><br><span class="line">net.embeddings <span class="comment">#æŸ¥çœ‹ Embedding å±‚å†…éƒ¨çš„æŸ¥è¯¢è¡¨ table</span></span><br></pre></td></tr></table></figure>
<h2 id="é¢„è®­ç»ƒçš„è¯å‘é‡"><a href="#é¢„è®­ç»ƒçš„è¯å‘é‡" class="headerlink" title="é¢„è®­ç»ƒçš„è¯å‘é‡"></a>é¢„è®­ç»ƒçš„è¯å‘é‡</h2><ul>
<li>ç›®å‰åº”ç”¨çš„æ¯”è¾ƒå¹¿æ³›çš„é¢„è®­ç»ƒæ¨¡å‹æœ‰ Word2Vec å’Œ GloVe ç­‰ã€‚å®ƒä»¬å·²ç»åœ¨æµ·é‡è¯­æ–™åº“ è®­ç»ƒå¾—åˆ°äº†è¾ƒå¥½çš„è¯å‘é‡è¡¨ç¤ºæ–¹æ³•ï¼Œå¹¶å¯ä»¥ç›´æ¥å¯¼å‡ºå­¦ä¹ åˆ°çš„è¯å‘é‡è¡¨ï¼Œæ–¹ä¾¿è¿ç§»åˆ°å…¶å®ƒä»»åŠ¡ã€‚</li>
<li>åˆ©ç”¨æˆ‘ä»¬å·²ç»é¢„è®­ç»ƒå¥½çš„æ¨¡å‹å‚æ•°å»åˆå§‹åŒ– Embedding å±‚çš„æŸ¥è¯¢è¡¨ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»é¢„è®­ç»ƒæ¨¡å‹ä¸­åŠ è½½è¯å‘é‡è¡¨</span></span><br><span class="line">embed_glove = load_embed(<span class="string">'glove.6B.50d.txt'</span>) </span><br><span class="line"><span class="comment"># ç›´æ¥åˆ©ç”¨é¢„è®­ç»ƒçš„è¯å‘é‡è¡¨åˆå§‹åŒ– Embedding å±‚ </span></span><br><span class="line">net.set_weights([embed_glove])</span><br></pre></td></tr></table></figure>

<ul>
<li>é¢„è®­ç»ƒçš„è¯å‘é‡æ¨¡å‹åˆå§‹åŒ–çš„ Embedding å±‚å¯ä»¥è®¾ç½®ä¸ºä¸å‚ä¸è®­ç»ƒ:net.trainable =<br>Falseï¼Œé‚£ä¹ˆé¢„è®­ç»ƒçš„è¯å‘é‡å°±ç›´æ¥åº”ç”¨åˆ°æ­¤ç‰¹å®šä»»åŠ¡ä¸Š;å¦‚æœå¸Œæœ›èƒ½å¤Ÿå­¦åˆ°åŒºåˆ«äºé¢„è®­ ç»ƒè¯å‘é‡æ¨¡å‹ä¸åŒçš„è¡¨ç¤ºæ–¹æ³•ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠ<br>Embedding å±‚åŒ…å«è¿›åå‘ä¼ æ’­ç®—æ³•ä¸­å»ï¼Œåˆ©ç”¨ æ¢¯åº¦ä¸‹é™æ¥å¾®è°ƒå•è¯è¡¨ç¤ºæ–¹æ³•ã€‚</li>
</ul>
<h1 id="RNN-å±‚ä½¿ç”¨æ–¹æ³•"><a href="#RNN-å±‚ä½¿ç”¨æ–¹æ³•" class="headerlink" title="RNN å±‚ä½¿ç”¨æ–¹æ³•"></a>RNN å±‚ä½¿ç”¨æ–¹æ³•</h1><ul>
<li>åœ¨ TensorFlow ä¸­ï¼Œå¯ä»¥é€šè¿‡ layers.SimpleRNNCell æ¥å®Œæˆğœ(ğ‘¾ ğ’™ğ‘¡ + ğ‘¾ ğ‘¡âˆ’1 + ğ’ƒ)è®¡ç®—ã€‚</li>
<li>åœ¨ TensorFlow ä¸­ï¼ŒRNN è¡¨ç¤ºé€šç”¨æ„ä¹‰ä¸Šçš„å¾ªç¯ç¥ç»ç½‘ç»œï¼Œå¯¹äºæˆ‘ä»¬ç›®å‰ä»‹ç»çš„åŸºç¡€å¾ªç¯ç¥ç»ç½‘ç»œï¼Œå®ƒä¸€èˆ¬å«åš SimpleRNNã€‚SimpleRNN ä¸ SimpleRNNCell çš„ åŒºåˆ«åœ¨äºï¼Œå¸¦ Cell çš„å±‚ä»…ä»…æ˜¯å®Œæˆäº†ä¸€ä¸ªæ—¶é—´æˆ³çš„å‰å‘è¿ç®—ï¼Œä¸å¸¦ Cell çš„å±‚ä¸€èˆ¬æ˜¯åŸºäº Cell å±‚å®ç°çš„ï¼Œå®ƒåœ¨å†…éƒ¨å·²ç»å®Œæˆäº†å¤šä¸ªæ—¶é—´æˆ³çš„å¾ªç¯è¿ç®—ï¼Œå› æ­¤ä½¿ç”¨èµ·æ¥æ›´ä¸ºæ–¹ä¾¿å¿«æ·ã€‚</li>
</ul>
<h2 id="SimpleRNNCell"><a href="#SimpleRNNCell" class="headerlink" title="SimpleRNNCell"></a>SimpleRNNCell</h2><ul>
<li>ä»¥æŸè¾“å…¥ç‰¹å¾é•¿åº¦ğ‘› = 4ï¼ŒCell çŠ¶æ€å‘é‡ç‰¹å¾é•¿åº¦h = 3ä¸ºä¾‹ï¼Œé¦–å…ˆæˆ‘ä»¬æ–°å»ºä¸€ä¸ª SimpleRNNCellï¼Œä¸éœ€è¦æŒ‡å®šåºåˆ—é•¿åº¦ğ‘ </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cell = layers.SimpleRNNCell(<span class="number">3</span>) <span class="comment"># åˆ›å»º RNN Cellï¼Œå†…å­˜å‘é‡é•¿åº¦ä¸º 3 </span></span><br><span class="line">cell.build(input_shape=(<span class="literal">None</span>,<span class="number">4</span>)) <span class="comment"># è¾“å‡ºç‰¹å¾é•¿åº¦ n=4</span></span><br><span class="line">cell.trainable_variables <span class="comment"># æ‰“å° wxh, whh, b å¼ é‡</span></span><br><span class="line">output:</span><br><span class="line">[&lt;tf.Variable <span class="string">'kernel:0'</span> shape=(<span class="number">4</span>, <span class="number">3</span>) dtype=float32, numpy=...&gt;,</span><br><span class="line"> &lt;tf.Variable <span class="string">'recurrent_kernel:0'</span> shape=(<span class="number">3</span>, <span class="number">3</span>) dtype=float32, numpy=...&gt;,</span><br><span class="line"> &lt;tf.Variable <span class="string">'bias:0'</span> shape=(<span class="number">3</span>,) dtype=float32, numpy=array([<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">dtype=float32)&gt;]</span><br></pre></td></tr></table></figure>
<p>SimpleRNNCellå†…éƒ¨ç»´æŠ¤äº†3ä¸ªå¼ é‡ï¼Œkernelå˜é‡å³ğ‘¾ å¼ é‡ï¼Œrecurrent_kernel å˜é‡å³ğ‘¾ å¼ é‡ï¼Œbiaså˜é‡å³åç½®ğ’ƒå‘é‡ã€‚ä½†æ˜¯RNNçš„Memoryå‘é‡å¹¶ä¸ç”±SimpleRNNCellç»´æŠ¤ï¼Œéœ€è¦ç”¨æˆ·è‡ªè¡Œåˆå§‹åŒ–å‘é‡ ğŸå¹¶è®°å½•æ¯ä¸ªæ—¶é—´æˆ³ä¸Šçš„ ht.<br><img src="https://img-blog.csdnimg.cn/20201205132144831.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ul>
<li>å¯¹äº SimpleRNNCell æ¥è¯´ï¼Œğ’ğ‘¡ = ğ‘¡ï¼Œå¹¶æ²¡æœ‰ç»è¿‡é¢å¤–çš„çº¿æ€§å±‚è½¬æ¢ï¼Œæ˜¯åŒä¸€ä¸ªå¯¹è±¡;[ ğ‘¡] é€šè¿‡ä¸€ä¸ª List åŒ…è£¹èµ·æ¥ï¼Œè¿™ä¹ˆè®¾ç½®æ˜¯ä¸ºäº†ä¸ LSTMã€GRU ç­‰ RNN å˜ç§æ ¼å¼ç»Ÿä¸€ã€‚åœ¨å¾ªç¯ ç¥ç»ç½‘ç»œçš„åˆå§‹åŒ–é˜¶æ®µï¼ŒçŠ¶æ€å‘é‡ ğŸä¸€èˆ¬åˆå§‹åŒ–ä¸ºå…¨0å‘é‡.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ–çŠ¶æ€å‘é‡ï¼Œç”¨åˆ—è¡¨åŒ…è£¹ï¼Œç»Ÿä¸€æ ¼å¼</span></span><br><span class="line">h0 = [tf.zeros([<span class="number">4</span>, <span class="number">64</span>])]</span><br><span class="line">x = tf.random.normal([<span class="number">4</span>, <span class="number">80</span>, <span class="number">100</span>]) <span class="comment"># ç”Ÿæˆè¾“å…¥å¼ é‡ï¼Œ4 ä¸ª 80 å•è¯çš„å¥å­ </span></span><br><span class="line">xt = x[:,<span class="number">0</span>,:] <span class="comment"># æ‰€æœ‰å¥å­çš„ç¬¬ 1 ä¸ªå•è¯</span></span><br><span class="line"><span class="comment"># æ„å»ºè¾“å…¥ç‰¹å¾ n=100,åºåˆ—é•¿åº¦ s=80,çŠ¶æ€é•¿åº¦=64 çš„ Cell </span></span><br><span class="line">cell = layers.SimpleRNNCell(<span class="number">64</span>)</span><br><span class="line">out, h1 = cell(xt, h0) <span class="comment"># å‰å‘è®¡ç®— </span></span><br><span class="line">print(out.shape, h1[<span class="number">0</span>].shape)</span><br><span class="line">outputï¼š(<span class="number">4</span>, <span class="number">64</span>) (<span class="number">4</span>, <span class="number">64</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹äºé•¿åº¦ä¸ºğ‘ çš„è®­ç»ƒæ¥è¯´ï¼Œéœ€è¦å¾ªç¯é€šè¿‡ Cell ç±»ğ‘ æ¬¡æ‰ç®—å®Œæˆä¸€æ¬¡ç½‘ç»œå±‚çš„å‰å‘è¿ç®—</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">h = h0 <span class="comment"># hä¿å­˜æ¯ä¸ªæ—¶é—´æˆ³ä¸Šçš„çŠ¶æ€å‘é‡åˆ—è¡¨ # åœ¨åºåˆ—é•¿åº¦çš„ç»´åº¦è§£å¼€è¾“å…¥ï¼Œå¾—åˆ° xt:[b,n]</span></span><br><span class="line"><span class="keyword">for</span> xt <span class="keyword">in</span> tf.unstack(x, axis=<span class="number">1</span>):</span><br><span class="line">	out, h = cell(xt, h) <span class="comment"># å‰å‘è®¡ç®—,out å’Œ h å‡è¢«è¦†ç›–</span></span><br><span class="line"><span class="comment"># æœ€ç»ˆè¾“å‡ºå¯ä»¥èšåˆæ¯ä¸ªæ—¶é—´æˆ³ä¸Šçš„è¾“å‡ºï¼Œä¹Ÿå¯ä»¥åªå–æœ€åæ—¶é—´æˆ³çš„è¾“å‡º </span></span><br><span class="line">out = out</span><br></pre></td></tr></table></figure>
<h2 id="å¤šå±‚-SimpleRNNCell-ç½‘ç»œ"><a href="#å¤šå±‚-SimpleRNNCell-ç½‘ç»œ" class="headerlink" title="å¤šå±‚ SimpleRNNCell ç½‘ç»œ"></a>å¤šå±‚ SimpleRNNCell ç½‘ç»œ</h2><p>é€šè¿‡åœ¨æ·±åº¦æ–¹å‘å †å å¤šä¸ª Cell ç±»æ¥å®ç°æ·±å±‚å·ç§¯ç¥ç»ç½‘ç»œä¸€æ ·çš„æ•ˆæœï¼Œå¤§å¤§çš„æå‡ç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<ul>
<li>åˆ©ç”¨ Cell æ–¹å¼æ„å»ºå¤šå±‚ RNN ç½‘ç»œã€‚é¦–å…ˆ æ–°å»ºä¸¤ä¸ª SimpleRNNCell å•å…ƒ</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = tf.random.normal([<span class="number">4</span>,<span class="number">80</span>,<span class="number">100</span>]) </span><br><span class="line">xt = x[:,<span class="number">0</span>,:] <span class="comment"># å–ç¬¬ä¸€ä¸ªæ—¶é—´æˆ³çš„è¾“å…¥ x0</span></span><br><span class="line"><span class="comment"># æ„å»º 2 ä¸ª Cell,å…ˆ cell0,å cell1ï¼Œå†…å­˜çŠ¶æ€å‘é‡é•¿åº¦éƒ½ä¸º 64 </span></span><br><span class="line">cell0 = layers.SimpleRNNCell(<span class="number">64</span>)</span><br><span class="line">cell1 = layers.SimpleRNNCell(<span class="number">64</span>)</span><br><span class="line">h0 = [tf.zeros([<span class="number">4</span>,<span class="number">64</span>])] <span class="comment"># cell0çš„åˆå§‹çŠ¶æ€å‘é‡ </span></span><br><span class="line">h1 = [tf.zeros([<span class="number">4</span>,<span class="number">64</span>])] <span class="comment"># cell1çš„åˆå§‹çŠ¶æ€å‘é‡</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨æ—¶é—´è½´ä¸Šé¢å¾ªç¯è®¡ç®—å¤šæ¬¡æ¥å®ç°æ•´ä¸ªç½‘ç»œçš„å‰å‘è¿ç®—ï¼Œæ¯ä¸ªæ—¶é—´æˆ³ä¸Šçš„è¾“å…¥ xt é¦–å…ˆé€šè¿‡ ç¬¬ä¸€å±‚ï¼Œå¾—åˆ°è¾“å‡º out0ï¼Œå†é€šè¿‡ç¬¬äºŒå±‚ï¼Œå¾—åˆ°è¾“å‡º out1</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> xt <span class="keyword">in</span> tf.unstack(x, axis=<span class="number">1</span>):</span><br><span class="line"><span class="comment"># xtä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸ºout0</span></span><br><span class="line">	out0, h0 = cell0(xt, h0)</span><br><span class="line"><span class="comment"># ä¸Šä¸€ä¸ª cell çš„è¾“å‡º out0 ä½œä¸ºæœ¬ cell çš„è¾“å…¥</span></span><br><span class="line">   out1, h1 = cell1(out0, h1)</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¹Ÿå¯ä»¥å…ˆå®Œæˆè¾“å…¥åœ¨ç¬¬ä¸€å±‚ä¸Šæ‰€æœ‰æ—¶é—´æˆ³çš„è®¡ç®—ï¼Œå¹¶ä¿å­˜ç¬¬ä¸€å±‚åœ¨æ‰€æœ‰æ—¶é—´ æˆ³ä¸Šçš„è¾“å‡ºåˆ—è¡¨ï¼Œå†è®¡ç®—ç¬¬äºŒå±‚ã€ç¬¬ä¸‰å±‚ç­‰çš„ä¼ æ’­ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿å­˜ä¸Šä¸€å±‚çš„æ‰€æœ‰æ—¶é—´æˆ³ä¸Šé¢çš„è¾“å‡º </span></span><br><span class="line">middle_sequences = []</span><br><span class="line"><span class="comment"># è®¡ç®—ç¬¬ä¸€å±‚çš„æ‰€æœ‰æ—¶é—´æˆ³ä¸Šçš„è¾“å‡ºï¼Œå¹¶ä¿å­˜ </span></span><br><span class="line"><span class="keyword">for</span> xt <span class="keyword">in</span> tf.unstack(x, axis=<span class="number">1</span>):</span><br><span class="line">   out0, h0 = cell0(xt, h0)</span><br><span class="line">   middle_sequences.append(out0)</span><br><span class="line"><span class="comment"># è®¡ç®—ç¬¬äºŒå±‚çš„æ‰€æœ‰æ—¶é—´æˆ³ä¸Šçš„è¾“å‡º</span></span><br><span class="line"><span class="comment"># å¦‚æœä¸æ˜¯æœ«å±‚ï¼Œéœ€è¦ä¿å­˜æ‰€æœ‰æ—¶é—´æˆ³ä¸Šé¢çš„è¾“å‡º </span></span><br><span class="line"><span class="keyword">for</span> xt <span class="keyword">in</span> middle_sequences:</span><br><span class="line">   out1, h1 = cell1(xt, h1)</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œæœ€æœ«å±‚ Cell çš„çŠ¶æ€æœ‰å¯èƒ½ä¿å­˜äº†é«˜å±‚çš„å…¨å±€è¯­ä¹‰ç‰¹å¾ï¼Œå› æ­¤ä¸€èˆ¬ä½¿ç”¨æœ€æœ«å±‚çš„è¾“å‡ºä½œä¸ºåç»­ä»»åŠ¡ç½‘ç»œçš„è¾“å…¥ã€‚æ›´ç‰¹åˆ«åœ°ï¼Œæ¯å±‚æœ€åä¸€ä¸ªæ—¶é—´æˆ³ä¸Šçš„çŠ¶æ€è¾“å‡ºåŒ…å«äº†æ•´ä¸ªåºåˆ—çš„å…¨å±€ä¿¡æ¯ï¼Œå¦‚æœåªå¸Œæœ›é€‰ç”¨ ä¸€ä¸ªçŠ¶æ€å˜é‡æ¥å®Œæˆåç»­ä»»åŠ¡ï¼Œæ¯”å¦‚æƒ…æ„Ÿåˆ†ç±»é—®é¢˜ï¼Œä¸€èˆ¬é€‰ç”¨æœ€æœ«å±‚ã€æœ€æœ«æ—¶é—´æˆ³çš„çŠ¶æ€ è¾“å‡ºæœ€ä¸ºåˆé€‚ã€‚</li>
</ul>
<h2 id="SimpleRNN-å±‚"><a href="#SimpleRNN-å±‚" class="headerlink" title="SimpleRNN å±‚"></a>SimpleRNN å±‚</h2><ul>
<li>é€šè¿‡ SimpleRNNå±‚é«˜å±‚æ¥å£å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¸®åŠ©æˆ‘ä»¬å®ç°è‡ªåŠ¨è¿›è¡Œå¾ªç¯ç¥ç»ç½‘ç»œå†…éƒ¨çš„è®¡ç®—è¿‡ç¨‹ï¼Œæ¯”å¦‚æ¯ä¸€å±‚çš„ çŠ¶æ€å‘é‡çš„åˆå§‹åŒ–ï¼Œä»¥åŠæ¯ä¸€å±‚åœ¨æ—¶é—´è½´ä¸Šå±•å¼€çš„è¿ç®—</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">layer = layers.SimpleRNN(<span class="number">64</span>) <span class="comment"># åˆ›å»ºçŠ¶æ€å‘é‡é•¿åº¦ä¸º 64 çš„ SimpleRNN å±‚ </span></span><br><span class="line">x = tf.random.normal([<span class="number">4</span>, <span class="number">80</span>, <span class="number">100</span>])</span><br><span class="line">out = layer(x) <span class="comment"># å’Œæ™®é€šå·ç§¯ç½‘ç»œä¸€æ ·ï¼Œä¸€è¡Œä»£ç å³å¯è·å¾—è¾“å‡º</span></span><br><span class="line">out.shape</span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡ SimpleRNN å¯ä»¥ä»…éœ€ä¸€è¡Œä»£ç å³å¯å®Œæˆæ•´ä¸ªå‰å‘è¿ç®—è¿‡ç¨‹ï¼Œå®ƒé»˜è®¤è¿”å›æœ€ åä¸€ä¸ªæ—¶é—´æˆ³ä¸Šçš„è¾“å‡ºã€‚å¦‚æœå¸Œæœ›è¿”å›æ‰€æœ‰æ—¶é—´æˆ³ä¸Šçš„è¾“å‡ºåˆ—è¡¨ï¼Œå¯ä»¥è®¾ç½® return_sequences=True å‚æ•°</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º RNN å±‚æ—¶ï¼Œè®¾ç½®è¿”å›æ‰€æœ‰æ—¶é—´æˆ³ä¸Šçš„è¾“å‡º</span></span><br><span class="line">layer = layers.SimpleRNN(<span class="number">64</span>,return_sequences=<span class="literal">True</span>) </span><br><span class="line">out = layer(x) <span class="comment"># å‰å‘è®¡ç®—</span></span><br><span class="line">out <span class="comment"># è¾“å‡ºï¼Œè‡ªåŠ¨è¿›è¡Œäº† concat æ“ä½œ</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹äºå¤šå±‚å¾ªç¯ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å †å å¤šä¸ª SimpleRNN å®ç°</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">net = keras.Sequential([ <span class="comment"># æ„å»º 2 å±‚ RNN ç½‘ç»œ</span></span><br><span class="line"><span class="comment"># é™¤æœ€æœ«å±‚å¤–ï¼Œéƒ½éœ€è¦è¿”å›æ‰€æœ‰æ—¶é—´æˆ³çš„è¾“å‡ºï¼Œç”¨ä½œä¸‹ä¸€å±‚çš„è¾“å…¥ </span></span><br><span class="line">layers.SimpleRNN(<span class="number">64</span>, return_sequences=<span class="literal">True</span>), </span><br><span class="line">layers.SimpleRNN(<span class="number">64</span>),</span><br><span class="line">])</span><br><span class="line">out = net(x) <span class="comment"># å‰å‘è®¡ç®—</span></span><br></pre></td></tr></table></figure>
<h1 id="RNN-æƒ…æ„Ÿåˆ†ç±»é—®é¢˜å®æˆ˜"><a href="#RNN-æƒ…æ„Ÿåˆ†ç±»é—®é¢˜å®æˆ˜" class="headerlink" title="RNN æƒ…æ„Ÿåˆ†ç±»é—®é¢˜å®æˆ˜"></a>RNN æƒ…æ„Ÿåˆ†ç±»é—®é¢˜å®æˆ˜</h1><p><img src="https://img-blog.csdnimg.cn/20201205135047953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JhaWR1XzQxODcxNzk0,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>RNN ç½‘ç»œå…±ä¸¤å±‚ï¼Œå¾ªç¯æå–åºåˆ—ä¿¡å·çš„è¯­ä¹‰ç‰¹å¾ï¼Œåˆ©ç”¨ç¬¬2å±‚RNNå±‚çš„æœ€åæ—¶é—´æˆ³çš„çŠ¶æ€å‘é‡ hs(2)<br>ä½œä¸ºå¥å­çš„å…¨å±€è¯­ä¹‰ç‰¹å¾è¡¨ç¤ºï¼Œé€å…¥å…¨è¿æ¥å±‚æ„æˆçš„åˆ†ç±»ç½‘ç»œ 3ï¼Œå¾—åˆ°æ ·æœ¬ğ’™ä¸ºç§¯ææƒ…æ„Ÿçš„æ¦‚ç‡P(ğ’™ä¸ºç§¯ææƒ…æ„Ÿ|ğ’™) âˆˆ [0,1]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#%%</span></span><br><span class="line"><span class="keyword">import</span>  os</span><br><span class="line"><span class="keyword">import</span>  tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span>  numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span>    tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span>    tensorflow.keras <span class="keyword">import</span> layers, losses, optimizers, Sequential</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tf.random.set_seed(<span class="number">22</span>)</span><br><span class="line">np.random.seed(<span class="number">22</span>)</span><br><span class="line">os.environ[<span class="string">'TF_CPP_MIN_LOG_LEVEL'</span>] = <span class="string">'2'</span></span><br><span class="line"><span class="keyword">assert</span> tf.__version__.startswith(<span class="string">'2.'</span>)</span><br><span class="line"></span><br><span class="line">batchsz = <span class="number">128</span> <span class="comment"># æ‰¹é‡å¤§å°</span></span><br><span class="line">total_words = <span class="number">10000</span> <span class="comment"># è¯æ±‡è¡¨å¤§å°N_vocab</span></span><br><span class="line">max_review_len = <span class="number">80</span> <span class="comment"># å¥å­æœ€å¤§é•¿åº¦sï¼Œå¤§äºçš„å¥å­éƒ¨åˆ†å°†æˆªæ–­ï¼Œå°äºçš„å°†å¡«å……</span></span><br><span class="line">embedding_len = <span class="number">100</span> <span class="comment"># è¯å‘é‡ç‰¹å¾é•¿åº¦f</span></span><br><span class="line"><span class="comment"># åŠ è½½IMDBæ•°æ®é›†ï¼Œæ­¤å¤„çš„æ•°æ®é‡‡ç”¨æ•°å­—ç¼–ç ï¼Œä¸€ä¸ªæ•°å­—ä»£è¡¨ä¸€ä¸ªå•è¯</span></span><br><span class="line">(x_train, y_train), (x_test, y_test) = keras.datasets.imdb.load_data(num_words=total_words)</span><br><span class="line">print(x_train.shape, len(x_train[<span class="number">0</span>]), y_train.shape)</span><br><span class="line">print(x_test.shape, len(x_test[<span class="number">0</span>]), y_test.shape)</span><br><span class="line"><span class="comment">#%%</span></span><br><span class="line">x_train[<span class="number">0</span>]</span><br><span class="line"><span class="comment">#%%</span></span><br><span class="line"><span class="comment"># æ•°å­—ç¼–ç è¡¨</span></span><br><span class="line">word_index = keras.datasets.imdb.get_word_index()</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># æ‰“å°å‡ºç¼–ç è¡¨çš„å•è¯å’Œå¯¹åº”çš„æ•°å­—</span></span><br><span class="line"><span class="comment"># for k,v in word_index.items():</span></span><br><span class="line"><span class="comment">#     print(k,v)</span></span><br><span class="line"><span class="comment">#%%</span></span><br><span class="line">word_index = &#123;k:(v+<span class="number">3</span>) <span class="keyword">for</span> k,v <span class="keyword">in</span> word_index.items()&#125;</span><br><span class="line">word_index[<span class="string">"&lt;PAD&gt;"</span>] = <span class="number">0</span>  <span class="comment"># å¡«å……æ ‡å¿—</span></span><br><span class="line">word_index[<span class="string">"&lt;START&gt;"</span>] = <span class="number">1</span>  <span class="comment"># èµ·å§‹æ ‡å¿—</span></span><br><span class="line">word_index[<span class="string">"&lt;UNK&gt;"</span>] = <span class="number">2</span>  <span class="comment"># unknown  æœªçŸ¥å•è¯çš„æ ‡å¿—</span></span><br><span class="line">word_index[<span class="string">"&lt;UNUSED&gt;"</span>] = <span class="number">3</span></span><br><span class="line"><span class="comment"># ç¿»è½¬ç¼–ç è¡¨</span></span><br><span class="line">reverse_word_index = dict([(value, key) <span class="keyword">for</span> (key, value) <span class="keyword">in</span> word_index.items()])</span><br><span class="line"><span class="comment">#å¯¹äºä¸€ä¸ªæ•°å­—ç¼–ç çš„å¥å­ï¼Œé€šè¿‡å¦‚ä¸‹å‡½æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_review</span><span class="params">(text)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">' '</span>.join([reverse_word_index.get(i, <span class="string">'?'</span>) <span class="keyword">for</span> i <span class="keyword">in</span> text])</span><br><span class="line"></span><br><span class="line">decode_review(x_train[<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#%%</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># x_train:[b, 80]</span></span><br><span class="line"><span class="comment"># x_test: [b, 80]</span></span><br><span class="line"><span class="comment"># æˆªæ–­å’Œå¡«å……å¥å­ï¼Œä½¿å¾—ç­‰é•¿ï¼Œæ­¤å¤„é•¿å¥å­ä¿ç•™å¥å­åé¢çš„éƒ¨åˆ†ï¼ŒçŸ­å¥å­åœ¨å‰é¢å¡«å……</span></span><br><span class="line">x_train = keras.preprocessing.sequence.pad_sequences(x_train, maxlen=max_review_len)</span><br><span class="line">x_test = keras.preprocessing.sequence.pad_sequences(x_test, maxlen=max_review_len)</span><br><span class="line"><span class="comment"># æ„å»ºæ•°æ®é›†ï¼Œæ‰“æ•£ï¼Œæ‰¹é‡ï¼Œå¹¶ä¸¢æ‰æœ€åä¸€ä¸ªä¸å¤Ÿbatchszçš„batch</span></span><br><span class="line">db_train = tf.data.Dataset.from_tensor_slices((x_train, y_train))</span><br><span class="line">db_train = db_train.shuffle(<span class="number">1000</span>).batch(batchsz, drop_remainder=<span class="literal">True</span>)</span><br><span class="line">db_test = tf.data.Dataset.from_tensor_slices((x_test, y_test))</span><br><span class="line">db_test = db_test.batch(batchsz, drop_remainder=<span class="literal">True</span>)</span><br><span class="line">print(<span class="string">'x_train shape:'</span>, x_train.shape, tf.reduce_max(y_train), tf.reduce_min(y_train))</span><br><span class="line">print(<span class="string">'x_test shape:'</span>, x_test.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment">#%%</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyRNN</span><span class="params">(keras.Model)</span>:</span></span><br><span class="line">    <span class="comment"># Cellæ–¹å¼æ„å»ºå¤šå±‚ç½‘ç»œ</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, units)</span>:</span></span><br><span class="line">        super(MyRNN, self).__init__()</span><br><span class="line">        <span class="comment"># [b, 64]ï¼Œæ„å»ºCellåˆå§‹åŒ–çŠ¶æ€å‘é‡ï¼Œé‡å¤ä½¿ç”¨</span></span><br><span class="line">        self.state0 = [tf.zeros([batchsz, units])]</span><br><span class="line">        self.state1 = [tf.zeros([batchsz, units])]</span><br><span class="line">        <span class="comment"># è¯å‘é‡ç¼–ç  [b, 80] =&gt; [b, 80, 100]</span></span><br><span class="line">        self.embedding = layers.Embedding(total_words, embedding_len,</span><br><span class="line">                                          input_length=max_review_len)</span><br><span class="line">        <span class="comment"># æ„å»º2ä¸ªCell</span></span><br><span class="line">        self.rnn_cell0 = layers.SimpleRNNCell(units, dropout=<span class="number">0.5</span>)</span><br><span class="line">        self.rnn_cell1 = layers.SimpleRNNCell(units, dropout=<span class="number">0.5</span>)</span><br><span class="line">        <span class="comment"># æ„å»ºåˆ†ç±»ç½‘ç»œï¼Œç”¨äºå°†CELLçš„è¾“å‡ºç‰¹å¾è¿›è¡Œåˆ†ç±»ï¼Œ2åˆ†ç±»</span></span><br><span class="line">        <span class="comment"># [b, 80, 100] =&gt; [b, 64] =&gt; [b, 1]</span></span><br><span class="line">        self.outlayer = Sequential([</span><br><span class="line">        	layers.Dense(units),</span><br><span class="line">        	layers.Dropout(rate=<span class="number">0.5</span>),</span><br><span class="line">        	layers.ReLU(),</span><br><span class="line">        	layers.Dense(<span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self, inputs, training=None)</span>:</span></span><br><span class="line">        x = inputs <span class="comment"># [b, 80]</span></span><br><span class="line">        <span class="comment"># embedding: [b, 80] =&gt; [b, 80, 100]</span></span><br><span class="line">        <span class="comment"># è·å–è¯å‘é‡: [b, 80] =&gt; [b, 80, 100]</span></span><br><span class="line">        x = self.embedding(x)</span><br><span class="line">        <span class="comment"># rnn cell compute,[b, 80, 100] =&gt; [b, 64]</span></span><br><span class="line">        <span class="comment"># é€šè¿‡ 2 ä¸ª RNN CELL,[b, 80, 100] =&gt; [b, 64]</span></span><br><span class="line">        state0 = self.state0</span><br><span class="line">        state1 = self.state1</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> tf.unstack(x, axis=<span class="number">1</span>): <span class="comment"># word: [b, 100] </span></span><br><span class="line">            out0, state0 = self.rnn_cell0(word, state0, training) </span><br><span class="line">            out1, state1 = self.rnn_cell1(out0, state1, training)</span><br><span class="line">        <span class="comment"># æœ«å±‚æœ€åä¸€ä¸ªè¾“å‡ºä½œä¸ºåˆ†ç±»ç½‘ç»œçš„è¾“å…¥: [b, 64] =&gt; [b, 1]</span></span><br><span class="line">        x = self.outlayer(out1, training)</span><br><span class="line">        <span class="comment"># p(y is pos|x)</span></span><br><span class="line">        prob = tf.sigmoid(x)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> prob</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    units = <span class="number">64</span> <span class="comment"># RNNçŠ¶æ€å‘é‡é•¿åº¦f</span></span><br><span class="line">    epochs = <span class="number">50</span> <span class="comment"># è®­ç»ƒepochs</span></span><br><span class="line"></span><br><span class="line">    model = MyRNN(units)</span><br><span class="line">    <span class="comment"># è£…é…</span></span><br><span class="line">    model.compile(optimizer = optimizers.RMSprop(<span class="number">0.001</span>),</span><br><span class="line">                  loss = losses.BinaryCrossentropy(),</span><br><span class="line">                  metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line">    <span class="comment"># è®­ç»ƒå’ŒéªŒè¯</span></span><br><span class="line">    model.fit(db_train, epochs=epochs, validation_data=db_test)</span><br><span class="line">    <span class="comment"># æµ‹è¯•</span></span><br><span class="line">    model.evaluate(db_test)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h1 id="æ¢¯åº¦å¼¥æ•£å’Œæ¢¯åº¦çˆ†ç‚¸"><a href="#æ¢¯åº¦å¼¥æ•£å’Œæ¢¯åº¦çˆ†ç‚¸" class="headerlink" title="æ¢¯åº¦å¼¥æ•£å’Œæ¢¯åº¦çˆ†ç‚¸"></a>æ¢¯åº¦å¼¥æ•£å’Œæ¢¯åº¦çˆ†ç‚¸</h1><h2 id="æ¢¯åº¦è£å‰ª"><a href="#æ¢¯åº¦è£å‰ª" class="headerlink" title="æ¢¯åº¦è£å‰ª"></a>æ¢¯åº¦è£å‰ª</h2><ul>
<li>æ¢¯åº¦çˆ†ç‚¸å¯ä»¥é€šè¿‡æ¢¯åº¦è£å‰ª(Gradient Clipping)çš„æ–¹å¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šçš„è§£å†³ã€‚æ¢¯åº¦è£å‰ª ä¸å¼ é‡é™å¹…éå¸¸ç±»ä¼¼ï¼Œä¹Ÿæ˜¯é€šè¿‡å°†æ¢¯åº¦å¼ é‡çš„æ•°å€¼æˆ–è€…èŒƒæ•°é™åˆ¶åœ¨æŸä¸ªè¾ƒå°çš„åŒºé—´å†…ï¼Œä» è€Œå°†è¿œå¤§äº 1 çš„æ¢¯åº¦å€¼å‡å°‘ï¼Œé¿å…å‡ºç°æ¢¯åº¦çˆ†ç‚¸ã€‚</li>
<li>ç›´æ¥å¯¹å¼ é‡çš„æ•°å€¼è¿›è¡Œé™å¹…ï¼Œä½¿å¾—å¼ é‡ğ‘¾çš„æ‰€æœ‰å…ƒç´ ğ‘¤ğ‘–ğ‘— âˆˆ [min, max]ã€‚åœ¨ TensorFlowä¸­ï¼Œå¯ä»¥é€šè¿‡ tf.clip_by_value()å‡½æ•°æ¥å®ç°ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=tf.random.uniform([<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line">tf.clip_by_value(a,<span class="number">0.4</span>,<span class="number">0.6</span>) <span class="comment"># æ¢¯åº¦å€¼è£å‰ª</span></span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡é™åˆ¶æ¢¯åº¦å¼ é‡ğ‘¾çš„èŒƒæ•°æ¥å®ç°æ¢¯åº¦è£å‰ªã€‚æ¯”å¦‚å¯¹ğ‘¾çš„äºŒèŒƒæ•°â€–ğ‘¾â€–2çº¦æŸåœ¨[0,max] ä¹‹é—´ï¼Œå¦‚æœâ€–ğ‘¾â€–2å¤§äºmaxå€¼ï¼Œåˆ™æŒ‰ç…§<br><img src="https://img-blog.csdnimg.cn/20201205140232940.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ–¹å¼å°†â€–ğ‘¾â€²â€–2çº¦æŸmaxå†…ã€‚å¯ä»¥é€šè¿‡ tf.clip_by_norm å‡½æ•°æ–¹ä¾¿çš„å®ç°æ¢¯åº¦å¼ é‡ğ‘¾è£å‰ª</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=tf.random.uniform([<span class="number">2</span>,<span class="number">2</span>]) * <span class="number">5</span></span><br><span class="line"><span class="comment"># æŒ‰èŒƒæ•°æ–¹å¼è£å‰ª</span></span><br><span class="line">b = tf.clip_by_norm(a, <span class="number">5</span>) </span><br><span class="line"><span class="comment"># è£å‰ªå‰å’Œè£å‰ªåçš„å¼ é‡èŒƒæ•° </span></span><br><span class="line">tf.norm(a),tf.norm(b)</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¥ç»ç½‘ç»œçš„æ›´æ–°æ–¹å‘æ˜¯ç”±æ‰€æœ‰å‚æ•°çš„æ¢¯åº¦å¼ é‡ğ‘¾å…±åŒè¡¨ç¤ºçš„ï¼Œå‰ä¸¤ç§æ–¹å¼åªè€ƒè™‘å•ä¸ª æ¢¯åº¦å¼ é‡çš„é™å¹…ï¼Œä¼šå‡ºç°ç½‘ç»œæ›´æ–°æ–¹å‘å‘ç”Ÿå˜åŠ¨çš„æƒ…å†µã€‚å¦‚æœèƒ½å¤Ÿè€ƒè™‘æ‰€æœ‰å‚æ•°çš„æ¢¯ åº¦ğ‘¾çš„èŒƒæ•°ï¼Œå®ç°ç­‰æ¯”ä¾‹çš„ç¼©æ”¾ï¼Œé‚£ä¹ˆå°±èƒ½æ—¢å¾ˆå¥½åœ°é™åˆ¶ç½‘ç»œçš„æ¢¯åº¦å€¼ï¼ŒåŒæ—¶ä¸æ”¹å˜ ç½‘ç»œçš„æ›´æ–°æ–¹å‘ã€‚è¿™å°±æ˜¯ç¬¬ä¸‰ç§æ¢¯åº¦è£å‰ªçš„æ–¹å¼:å…¨å±€èŒƒæ•°è£å‰ªã€‚åœ¨ TensorFlow ä¸­ï¼Œ å¯ä»¥é€šè¿‡ tf.clip_by_global_norm å‡½æ•°å¿«æ·åœ°ç¼©æ”¾æ•´ä½“ç½‘ç»œæ¢¯åº¦ğ‘¾çš„èŒƒæ•°ã€‚<br><img src="https://img-blog.csdnimg.cn/20201205140814287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JhaWR1XzQxODcxNzk0,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20201205140822877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JhaWR1XzQxODcxNzk0,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">w1=tf.random.normal([<span class="number">3</span>,<span class="number">3</span>]) <span class="comment"># åˆ›å»ºæ¢¯åº¦å¼ é‡ 1 </span></span><br><span class="line">w2=tf.random.normal([<span class="number">3</span>,<span class="number">3</span>]) <span class="comment"># åˆ›å»ºæ¢¯åº¦å¼ é‡ 2</span></span><br><span class="line"><span class="comment"># è®¡ç®— global norm </span></span><br><span class="line">global_norm=tf.math.sqrt(tf.norm(w1)**<span class="number">2</span>+tf.norm(w2)**<span class="number">2</span>) </span><br><span class="line"><span class="comment"># æ ¹æ® global norm å’Œ max norm=2 è£å‰ª </span></span><br><span class="line">(ww1,ww2),global_norm=tf.clip_by_global_norm([w1,w2],<span class="number">2</span>)</span><br><span class="line"><span class="comment"># è®¡ç®—è£å‰ªåçš„å¼ é‡ç»„çš„ global norm</span></span><br><span class="line">global_norm2 = tf.math.sqrt(tf.norm(ww1)**<span class="number">2</span>+tf.norm(ww2)**<span class="number">2</span>)</span><br><span class="line"><span class="comment"># æ‰“å°è£å‰ªå‰çš„å…¨å±€èŒƒæ•°å’Œè£å‰ªåçš„å…¨å±€èŒƒæ•° </span></span><br><span class="line">print(global_norm, global_norm2)</span><br><span class="line"><span class="comment">#tf.clip_by_global_norm è¿”å›è£å‰ªåçš„å¼ é‡ List å’Œ global_norm è¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­ global_norm è¡¨ç¤ºè£å‰ªå‰çš„æ¢¯åº¦æ€»èŒƒæ•°å’Œ</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨ç½‘ç»œè®­ç»ƒæ—¶ï¼Œæ¢¯åº¦è£å‰ªä¸€èˆ¬åœ¨è®¡ç®—å‡ºæ¢¯åº¦åï¼Œæ¢¯åº¦æ›´æ–°ä¹‹å‰è¿›è¡Œ</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> tape:</span><br><span class="line">	logits = model(x) <span class="comment"># å‰å‘ä¼ æ’­</span></span><br><span class="line">	loss = criteon(y, logits) <span class="comment"># è¯¯å·®è®¡ç®—</span></span><br><span class="line">	<span class="comment"># è®¡ç®—æ¢¯åº¦å€¼</span></span><br><span class="line">	grads = tape.gradient(loss, model.trainable_variables)</span><br><span class="line">	grads, _ = tf.clip_by_global_norm(grads, <span class="number">25</span>) </span><br><span class="line">	<span class="comment"># å…¨å±€æ¢¯åº¦è£å‰ª # åˆ©ç”¨è£å‰ªåçš„æ¢¯åº¦å¼ é‡æ›´æ–°å‚æ•°</span></span><br><span class="line">	optimizer.apply_gradients(zip(grads, model.trainable_variables))</span><br></pre></td></tr></table></figure>
<h2 id="æ¢¯åº¦å¼¥æ•£"><a href="#æ¢¯åº¦å¼¥æ•£" class="headerlink" title="æ¢¯åº¦å¼¥æ•£"></a>æ¢¯åº¦å¼¥æ•£</h2><p>å¯¹äºæ¢¯åº¦å¼¥æ•£ç°è±¡ï¼Œå¯ä»¥é€šè¿‡å¢å¤§å­¦ä¹ ç‡ã€å‡å°‘ç½‘ç»œæ·±åº¦ã€æ·»åŠ  Skip Connection ç­‰ä¸€ç³»åˆ—çš„æªæ–½æŠ‘åˆ¶</p>
<h1 id="LSTM-å±‚ä½¿ç”¨æ–¹æ³•"><a href="#LSTM-å±‚ä½¿ç”¨æ–¹æ³•" class="headerlink" title="LSTM å±‚ä½¿ç”¨æ–¹æ³•"></a>LSTM å±‚ä½¿ç”¨æ–¹æ³•</h1><h2 id="LSTMCell"><a href="#LSTMCell" class="headerlink" title="LSTMCell"></a>LSTMCell</h2><ul>
<li>LSTMCell çš„ç”¨æ³•å’Œ SimpleRNNCell åŸºæœ¬ä¸€è‡´ï¼ŒåŒºåˆ«åœ¨äº LSTM çš„çŠ¶æ€å˜é‡ List æœ‰ä¸¤ ä¸ªï¼Œå³[ hğ‘¡,ğ’„ğ‘¡]ï¼Œéœ€è¦åˆ†åˆ«åˆå§‹åŒ–ï¼Œå…¶ä¸­Listç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºhğ‘¡ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸ºğ’„ğ‘¡ã€‚è°ƒç”¨cell å®Œæˆå‰å‘è¿ç®—æ—¶ï¼Œè¿”å›ä¸¤ä¸ªå…ƒç´ ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºcellçš„è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯ hğ‘¡ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸º cellçš„æ›´æ–°åçš„çŠ¶æ€List:[ hğ‘¡,ğ’„ğ‘¡]ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = tf.random.normal([<span class="number">2</span>,<span class="number">80</span>,<span class="number">100</span>]) </span><br><span class="line">xt = x[:,<span class="number">0</span>,:] <span class="comment"># å¾—åˆ°ä¸€ä¸ªæ—¶é—´æˆ³çš„è¾“å…¥</span></span><br><span class="line">cell = layers.LSTMCell(<span class="number">64</span>) <span class="comment"># åˆ›å»º LSTM Cell # åˆå§‹åŒ–çŠ¶æ€å’Œè¾“å‡º List,[h,c]</span></span><br><span class="line">state = [tf.zeros([<span class="number">2</span>,<span class="number">64</span>]),tf.zeros([<span class="number">2</span>,<span class="number">64</span>])] </span><br><span class="line">out, state = cell(xt, state) <span class="comment"># å‰å‘è®¡ç®—</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¿”å›å…ƒç´ çš„ id</span></span><br><span class="line">id(out),id(state[<span class="number">0</span>]),id(state[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡åœ¨æ—¶é—´æˆ³ä¸Šå±•å¼€å¾ªç¯è¿ç®—ï¼Œå³å¯å®Œæˆä¸€æ¬¡å±‚çš„å‰å‘ä¼ æ’­ï¼Œå†™æ³•ä¸åŸºç¡€çš„ RNN ä¸€ æ ·</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨åºåˆ—é•¿åº¦ç»´åº¦ä¸Šè§£å¼€ï¼Œå¾ªç¯é€å…¥ LSTM Cell å•å…ƒ </span></span><br><span class="line"><span class="keyword">for</span> xt <span class="keyword">in</span> tf.unstack(x, axis=<span class="number">1</span>):</span><br><span class="line">	<span class="comment"># å‰å‘è®¡ç®—</span></span><br><span class="line">	out, state = cell(xt, state)</span><br></pre></td></tr></table></figure>
<h2 id="LSTM-å±‚"><a href="#LSTM-å±‚" class="headerlink" title="LSTM å±‚"></a>LSTM å±‚</h2><ul>
<li>é€šè¿‡ layers.LSTM å±‚å¯ä»¥æ–¹ä¾¿çš„ä¸€æ¬¡å®Œæˆæ•´ä¸ªåºåˆ—çš„è¿ç®—</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€å±‚ LSTM å±‚ï¼Œå†…å­˜å‘é‡é•¿åº¦ä¸º 64</span></span><br><span class="line">layer = layers.LSTM(<span class="number">64</span>)</span><br><span class="line"><span class="comment"># åºåˆ—é€šè¿‡ LSTM å±‚ï¼Œé»˜è®¤è¿”å›æœ€åä¸€ä¸ªæ—¶é—´æˆ³çš„è¾“å‡º h </span></span><br><span class="line">out = layer(x)</span><br></pre></td></tr></table></figure>

<ul>
<li>ç»è¿‡ LSTM å±‚å‰å‘ä¼ æ’­åï¼Œé»˜è®¤åªä¼šè¿”å›æœ€åä¸€ä¸ªæ—¶é—´æˆ³çš„è¾“å‡ºï¼Œå¦‚æœéœ€è¦è¿”å›æ¯ä¸ªæ—¶é—´ æˆ³ä¸Šé¢çš„è¾“å‡ºï¼Œéœ€è¦è®¾ç½® return_sequences=True æ ‡å¿—</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º LSTM å±‚æ—¶ï¼Œè®¾ç½®è¿”å›æ¯ä¸ªæ—¶é—´æˆ³ä¸Šçš„è¾“å‡º</span></span><br><span class="line">layer = layers.LSTM(<span class="number">64</span>, return_sequences=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># å‰å‘è®¡ç®—ï¼Œæ¯ä¸ªæ—¶é—´æˆ³ä¸Šçš„è¾“å‡ºè‡ªåŠ¨è¿›è¡Œäº† concatï¼Œæ‹¼æˆä¸€ä¸ªå¼ é‡ </span></span><br><span class="line">out = layer(x)</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹äºå¤šå±‚ç¥ç»ç½‘ç»œï¼Œå¯ä»¥é€šè¿‡ Sequential å®¹å™¨åŒ…è£¹å¤šå±‚ LSTM å±‚ï¼Œå¹¶è®¾ç½®æ‰€æœ‰éæœ«å±‚ ç½‘ç»œ return_sequences=Trueï¼Œè¿™æ˜¯å› ä¸ºéæœ«å±‚çš„ LSTM å±‚éœ€è¦ä¸Šä¸€å±‚åœ¨æ‰€æœ‰æ—¶é—´æˆ³çš„è¾“å‡ºä½œä¸ºè¾“å…¥</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">net = keras.Sequential([</span><br><span class="line">layers.LSTM(<span class="number">64</span>, return_sequences=<span class="literal">True</span>), <span class="comment"># éæœ«å±‚éœ€è¦è¿”å›æ‰€æœ‰æ—¶é—´æˆ³è¾“å‡º</span></span><br><span class="line">layers.LSTM(<span class="number">64</span>)</span><br><span class="line">])</span><br><span class="line"><span class="comment"># ä¸€æ¬¡é€šè¿‡ç½‘ç»œæ¨¡å‹ï¼Œå³å¯å¾—åˆ°æœ€æœ«å±‚ã€æœ€åä¸€ä¸ªæ—¶é—´æˆ³çš„è¾“å‡º </span></span><br><span class="line">out = net(x)</span><br></pre></td></tr></table></figure>


<h1 id="GRUå±‚ä½¿ç”¨æ–¹æ³•"><a href="#GRUå±‚ä½¿ç”¨æ–¹æ³•" class="headerlink" title="GRUå±‚ä½¿ç”¨æ–¹æ³•"></a>GRUå±‚ä½¿ç”¨æ–¹æ³•</h1><p>é—¨æ§å¾ªç¯ç½‘ç»œ(Gated Recurrent Unitï¼Œç®€ç§° GRU)æ˜¯åº”ç”¨æœ€å¹¿æ³›çš„ RNN å˜ç§ä¹‹ä¸€ã€‚GRU æŠŠå†…éƒ¨çŠ¶æ€å‘é‡å’Œè¾“å‡ºå‘é‡åˆå¹¶ï¼Œç»Ÿä¸€ä¸ºçŠ¶æ€å‘é‡ ï¼Œé—¨æ§æ•°é‡ä¹Ÿå‡å°‘åˆ° 2 ä¸ª:å¤ä½é—¨ (Reset Gate)å’Œæ›´æ–°é—¨(Update Gate).</p>
<h2 id="GRU-ä½¿ç”¨æ–¹æ³•"><a href="#GRU-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="GRU ä½¿ç”¨æ–¹æ³•"></a>GRU ä½¿ç”¨æ–¹æ³•</h2><ul>
<li>GRUCell çš„ä½¿ç”¨ï¼Œåˆ›å»º GRU Cell å¯¹è±¡ï¼Œå¹¶åœ¨æ—¶é—´è½´ä¸Šå¾ªç¯å±•å¼€è¿ç®—</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># åˆå§‹åŒ–çŠ¶æ€å‘é‡ï¼ŒGRU åªæœ‰ä¸€ä¸ª</span></span><br><span class="line">h = [tf.zeros([<span class="number">2</span>,<span class="number">64</span>])]</span><br><span class="line">cell = layers.GRUCell(<span class="number">64</span>) <span class="comment"># æ–°å»º GRU Cellï¼Œå‘é‡é•¿åº¦ä¸º 64</span></span><br><span class="line"><span class="comment"># åœ¨æ—¶é—´æˆ³ç»´åº¦ä¸Šè§£å¼€ï¼Œå¾ªç¯é€šè¿‡ cell </span></span><br><span class="line"><span class="keyword">for</span> xt <span class="keyword">in</span> tf.unstack(x, axis=<span class="number">1</span>):</span><br><span class="line">	out, h = cell(xt, h)</span><br><span class="line"><span class="comment"># è¾“å‡ºå½¢çŠ¶ out.shape</span></span><br><span class="line">out.shape</span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡ layers.GRU ç±»å¯ä»¥æ–¹ä¾¿åˆ›å»ºä¸€å±‚ GRU ç½‘ç»œå±‚ï¼Œé€šè¿‡ Sequential å®¹å™¨å¯ä»¥å †å å¤š å±‚ GRU å±‚çš„ç½‘ç»œ</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">net = keras.Sequential([</span><br><span class="line">   layers.GRU(<span class="number">64</span>, return_sequences=<span class="literal">True</span>),</span><br><span class="line">   layers.GRU(<span class="number">64</span>)</span><br><span class="line">])</span><br><span class="line">out = net(x)</span><br></pre></td></tr></table></figure>

<h1 id="LSTM-GRU-æƒ…æ„Ÿåˆ†ç±»é—®é¢˜"><a href="#LSTM-GRU-æƒ…æ„Ÿåˆ†ç±»é—®é¢˜" class="headerlink" title="LSTM/GRU æƒ…æ„Ÿåˆ†ç±»é—®é¢˜"></a>LSTM/GRU æƒ…æ„Ÿåˆ†ç±»é—®é¢˜</h1><h2 id="LSTM-æ¨¡å‹"><a href="#LSTM-æ¨¡å‹" class="headerlink" title="LSTM æ¨¡å‹"></a>LSTM æ¨¡å‹</h2><ul>
<li>Cell æ–¹å¼ã€‚LSTM ç½‘ç»œçš„çŠ¶æ€ List å…±æœ‰ä¸¤ä¸ªï¼Œéœ€è¦åˆ†åˆ«åˆå§‹åŒ–å„å±‚çš„hå’Œğ’„å‘é‡</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.state0 = [tf.zeros([batchsz, units]),tf.zeros([batchsz, units])]</span><br><span class="line">self.state1 = [tf.zeros([batchsz, units]),tf.zeros([batchsz, units])]</span><br></pre></td></tr></table></figure>

<ul>
<li>å°†æ¨¡å‹ä¿®æ”¹ä¸º LSTMCell æ¨¡å‹</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.rnn_cell0 = layers.LSTMCell(units, dropout=<span class="number">0.5</span>)</span><br><span class="line">self.rnn_cell1 = layers.LSTMCell(units, dropout=<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹äºå±‚æ–¹å¼ï¼Œåªéœ€è¦ä¿®æ”¹ç½‘ç»œæ¨¡å‹ä¸€å¤„</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»º RNNï¼Œæ¢æˆ LSTM ç±»å³å¯ </span></span><br><span class="line">self.rnn = keras.Sequential([</span><br><span class="line">   layers.LSTM(units, dropout=<span class="number">0.5</span>, return_sequences=<span class="literal">True</span>),</span><br><span class="line">   layers.LSTM(units, dropout=<span class="number">0.5</span>)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h2 id="GRUæ¨¡å‹"><a href="#GRUæ¨¡å‹" class="headerlink" title="GRUæ¨¡å‹"></a>GRUæ¨¡å‹</h2><ul>
<li>Cell æ–¹å¼ã€‚GRU çš„çŠ¶æ€ List åªæœ‰ä¸€ä¸ªï¼Œå’ŒåŸºç¡€ RNN ä¸€æ ·ï¼Œåªéœ€è¦ä¿®æ”¹åˆ›å»º Cell çš„ç±»å‹</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># æ„å»º2ä¸ªCell</span></span><br><span class="line">self.rnn_cell0 = layers.GRUCell(units, dropout=<span class="number">0.5</span>) </span><br><span class="line">self.rnn_cell1 = layers.GRUCell(units, dropout=<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>å±‚æ–¹å¼ï¼Œä¿®æ”¹ç½‘ç»œå±‚ç±»å‹</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»ºRNN</span></span><br><span class="line">self.rnn = keras.Sequential([</span><br><span class="line">   layers.GRU(units, dropout=<span class="number">0.5</span>, return_sequences=<span class="literal">True</span>),</span><br><span class="line">layers.GRU(units, dropout=<span class="number">0.5</span>)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<h1 id="é¢„è®­ç»ƒçš„è¯å‘é‡-1"><a href="#é¢„è®­ç»ƒçš„è¯å‘é‡-1" class="headerlink" title="é¢„è®­ç»ƒçš„è¯å‘é‡"></a>é¢„è®­ç»ƒçš„è¯å‘é‡</h1><ul>
<li>ä½¿ç”¨é¢„è®­ç»ƒçš„GloVe è¯å‘é‡</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'Indexing word vectors.'</span>)</span><br><span class="line">embeddings_index = &#123;&#125; <span class="comment"># æå–å•è¯åŠå…¶å‘é‡ï¼Œä¿å­˜åœ¨å­—å…¸ä¸­</span></span><br><span class="line"><span class="comment"># è¯å‘é‡æ¨¡å‹æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></span><br><span class="line">GLOVE_DIR = <span class="string">r'C:\Users\z390\Downloads\glove6b50dtxt'</span></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(GLOVE_DIR, <span class="string">'glove.6B.100d.txt'</span>),encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">   <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">       values = line.split()</span><br><span class="line">	   word = values[<span class="number">0</span>]</span><br><span class="line">       coefs = np.asarray(values[<span class="number">1</span>:], dtype=<span class="string">'float32'</span>)</span><br><span class="line">       embeddings_index[word] = coefs</span><br><span class="line">print(<span class="string">'Found %s word vectors.'</span> % len(embeddings_index))</span><br><span class="line">num_words = min(total_words, len(word_index))</span><br><span class="line">embedding_matrix = np.zeros((num_words, embedding_len)) <span class="comment">#è¯å‘é‡è¡¨ </span></span><br><span class="line"><span class="keyword">for</span> word, i <span class="keyword">in</span> word_index.items():</span><br><span class="line">	<span class="keyword">if</span> i &gt;= MAX_NUM_WORDS: </span><br><span class="line">		<span class="keyword">continue</span> <span class="comment"># è¿‡æ»¤æ‰å…¶ä»–è¯æ±‡</span></span><br><span class="line">embedding_vector = embeddings_index.get(word) <span class="comment"># ä» GloVe æŸ¥è¯¢è¯å‘é‡ </span></span><br><span class="line">	<span class="keyword">if</span> embedding_vector <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">       <span class="comment"># words not found in embedding index will be all-zeros.</span></span><br><span class="line">	   embedding_matrix[i] = embedding_vector <span class="comment"># å†™å…¥å¯¹åº”ä½ç½® </span></span><br><span class="line">print(applied_vec_count, embedding_matrix.shape)</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å¾—äº†è¯æ±‡è¡¨æ•°æ®åï¼Œåˆ©ç”¨è¯æ±‡è¡¨åˆå§‹åŒ– Embedding å±‚å³å¯ï¼Œå¹¶è®¾ç½® Embedding å±‚ ä¸å‚ä¸æ¢¯åº¦ä¼˜åŒ–</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º Embedding å±‚</span></span><br><span class="line">self.embedding = layers.Embedding(total_words, embedding_len,</span><br><span class="line">                            input_length=max_review_len,</span><br><span class="line">							trainable=<span class="literal">False</span>)<span class="comment">#ä¸å‚ä¸æ¢¯åº¦æ›´æ–° </span></span><br><span class="line">self.embedding.build(input_shape=(<span class="literal">None</span>, max_review_len))</span><br><span class="line"><span class="comment"># åˆ©ç”¨ GloVe æ¨¡å‹åˆå§‹åŒ– Embedding å±‚ </span></span><br><span class="line">self.embedding.set_weights([embedding_matrix])<span class="comment">#åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------æœ¬æ–‡ç»“æŸ<i class="fa fa-paw"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div>
    
</div>
  
</div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python/" rel="tag"><i class="fa fa-tag"></i></a>
              <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A1%86%E6%9E%B6/" rel="tag"><i class="fa fa-tag"></i></a>
              <a href="/tags/tensorflow/" rel="tag"><i class="fa fa-tag"></i></a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/12/04/Tensorflow-and-Convolutional-Neural-Network/" rel="prev" title="Tensorflowä¸å·ç§¯ç¥ç»ç½‘ç»œ">
      <i class="fa fa-chevron-left"></i> Tensorflowä¸å·ç§¯ç¥ç»ç½‘ç»œ
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/12/06/Tensorflow-and-Encoder-Decoder/" rel="next" title="Tensorflowä¸è‡ªç¼–ç å™¨">
      Tensorflowä¸è‡ªç¼–ç å™¨ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#åºåˆ—çš„è¡¨ç¤ºæ–¹æ³•"><span class="nav-number">1.</span> <span class="nav-text">åºåˆ—çš„è¡¨ç¤ºæ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Embedding-å±‚"><span class="nav-number">1.1.</span> <span class="nav-text">Embedding å±‚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é¢„è®­ç»ƒçš„è¯å‘é‡"><span class="nav-number">1.2.</span> <span class="nav-text">é¢„è®­ç»ƒçš„è¯å‘é‡</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RNN-å±‚ä½¿ç”¨æ–¹æ³•"><span class="nav-number">2.</span> <span class="nav-text">RNN å±‚ä½¿ç”¨æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SimpleRNNCell"><span class="nav-number">2.1.</span> <span class="nav-text">SimpleRNNCell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¤šå±‚-SimpleRNNCell-ç½‘ç»œ"><span class="nav-number">2.2.</span> <span class="nav-text">å¤šå±‚ SimpleRNNCell ç½‘ç»œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SimpleRNN-å±‚"><span class="nav-number">2.3.</span> <span class="nav-text">SimpleRNN å±‚</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RNN-æƒ…æ„Ÿåˆ†ç±»é—®é¢˜å®æˆ˜"><span class="nav-number">3.</span> <span class="nav-text">RNN æƒ…æ„Ÿåˆ†ç±»é—®é¢˜å®æˆ˜</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#æ¢¯åº¦å¼¥æ•£å’Œæ¢¯åº¦çˆ†ç‚¸"><span class="nav-number">4.</span> <span class="nav-text">æ¢¯åº¦å¼¥æ•£å’Œæ¢¯åº¦çˆ†ç‚¸</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¢¯åº¦è£å‰ª"><span class="nav-number">4.1.</span> <span class="nav-text">æ¢¯åº¦è£å‰ª</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¢¯åº¦å¼¥æ•£"><span class="nav-number">4.2.</span> <span class="nav-text">æ¢¯åº¦å¼¥æ•£</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#LSTM-å±‚ä½¿ç”¨æ–¹æ³•"><span class="nav-number">5.</span> <span class="nav-text">LSTM å±‚ä½¿ç”¨æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#LSTMCell"><span class="nav-number">5.1.</span> <span class="nav-text">LSTMCell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LSTM-å±‚"><span class="nav-number">5.2.</span> <span class="nav-text">LSTM å±‚</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#GRUå±‚ä½¿ç”¨æ–¹æ³•"><span class="nav-number">6.</span> <span class="nav-text">GRUå±‚ä½¿ç”¨æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GRU-ä½¿ç”¨æ–¹æ³•"><span class="nav-number">6.1.</span> <span class="nav-text">GRU ä½¿ç”¨æ–¹æ³•</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#LSTM-GRU-æƒ…æ„Ÿåˆ†ç±»é—®é¢˜"><span class="nav-number">7.</span> <span class="nav-text">LSTM&#x2F;GRU æƒ…æ„Ÿåˆ†ç±»é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#LSTM-æ¨¡å‹"><span class="nav-number">7.1.</span> <span class="nav-text">LSTM æ¨¡å‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GRUæ¨¡å‹"><span class="nav-number">7.2.</span> <span class="nav-text">GRUæ¨¡å‹</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#é¢„è®­ç»ƒçš„è¯å‘é‡-1"><span class="nav-number">8.</span> <span class="nav-text">é¢„è®­ç»ƒçš„è¯å‘é‡</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ccclll777</p>
  <div class="site-description" itemprop="description">èƒ¸æ€€çŒ›è™ ç»†å—…è”·è–‡</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">39</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ccclll777" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;ccclll777" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:sdu945860882@gmail.com" title="E-Mail â†’ mailto:sdu945860882@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.weibo.com/6732062654" title="Weibo â†’ https:&#x2F;&#x2F;www.weibo.com&#x2F;6732062654" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/baidu_41871794" title="CSDN â†’ https:&#x2F;&#x2F;blog.csdn.net&#x2F;baidu_41871794" rel="noopener" target="_blank"><i class="gratipay fa-fw"></i>CSDN</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ccclll777</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">391k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">5:55</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>



        








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>
    <script defer src="/lib/three/canvas_lines.min.js"></script>
    <script defer src="/lib/three/canvas_sphere.min.js"></script>


  















  

  

  

</body>
</html>
